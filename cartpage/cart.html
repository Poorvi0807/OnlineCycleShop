
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="cart.css">
    <title>Your Cart</title>
    
</head>

<body>
    <header>
        <div class="container">
            <h1>Your Cart</h1>
        </div>
    </header>
<!-- <img src="/addresspage/address.js" alt=""> -->
    <div class="container" id="parent">
        <!-- Cart items will be added dynamically here using JavaScript -->
        <!-- <div>
            <button></button>
        </div> -->
    </div>

    <script>
        const quantityMap = {}; 
        let totalAmount = 0;
    
        async function fetchData() {
            // Fetch data from the JSON server
            const response = await fetch('https://bicycle-shop-json-server.cyclic.app/bikes');
            const data = await response.json();
            return data;
        }
    
        // Function to update the price and subtotal
        function updatePriceAndSubtotal(item, quantityInput, priceElement, subtotalElement) {
            // Calculate price and subtotal
            const price = item.price;
            const quantity = quantityMap[item.id];
    
            priceElement.textContent = '$' + (price * quantity).toFixed(2);
    
            const subtotal = price * quantity;
            subtotalElement.textContent = '$' + subtotal.toFixed(2);
    
            // Calculate and update total
            totalAmount = Object.values(quantityMap).reduce((total, quantity) => {
                return total + (item.price * quantity);
            }, 0);
    
            document.getElementById('total-amount').textContent = '$' + totalAmount.toFixed(2);
        }
    
        async function renderCart() {
            const data = await fetchData();
            const parent = document.getElementById("parent");
    
            if (data.length === 0) {
                parent.textContent = "Cart Empty";
                const buttontxt = document.createElement('button');
                buttontxt.textContent = "Keep Shopping";
                parent.append(buttontxt);
            } else {
                data.forEach((item) => {
                    // Create cart item
                    const cartItem = document.createElement('div');
                    cartItem.classList.add('cart-item');
                    cartItem.id = item.id;
    
                    const img = new Image();
                    img.src = item.large_img;
    
                    const itemDetails = document.createElement('div');
                    itemDetails.classList.add('item-details');
    
                    const itemTitle = document.createElement('p');
                    itemTitle.classList.add('item-title');
                    itemTitle.textContent = item.title;
    
                    const itemPrice = document.createElement('p');
                    itemPrice.classList.add('item-price');
                    itemPrice.textContent = '$' + item.price.toFixed(2);
    
                    const quantity = document.createElement('div');
                    quantity.classList.add('quantity');
    
                    const decreaseButton = document.createElement('button');
                    decreaseButton.textContent = '-';
                    const quantityInput = document.createElement('input');
                    quantityInput.type = 'text';
                    quantityInput.value = '1';
                    const increaseButton = document.createElement('button');
                    increaseButton.textContent = '+';
    
                    quantity.append(decreaseButton, quantityInput, increaseButton);
    
                    const subtotal = document.createElement('div');
                    subtotal.classList.add('subtotal');
    
                    const subtotalPrice = document.createElement('p');
                    subtotalPrice.textContent = '$' + item.price.toFixed(2);
    
                    subtotal.append(subtotalPrice);
    
                    itemDetails.append(itemTitle, itemPrice, quantity);
                    cartItem.append(img, itemDetails, subtotal);
                    parent.append(cartItem);
    
                    // Attach click event handlers to +/- buttons
                    decreaseButton.addEventListener('click', () => {
                        if (quantityInput.value > 1) {
                            quantityInput.value = parseInt(quantityInput.value) - 1;
                            quantityMap[item.id] -= 1;
                            updatePriceAndSubtotal(item, quantityInput, itemPrice, subtotalPrice);
                        }
                    });
    
                    increaseButton.addEventListener('click', () => {
                        quantityInput.value = parseInt(quantityInput.value) + 1;
                        if (!quantityMap[item.id]) {
                            quantityMap[item.id] = 1;
                        } else {
                            quantityMap[item.id] += 1;
                        }
                        updatePriceAndSubtotal(item, quantityInput, itemPrice, subtotalPrice);
                    });
    
                    // Store initial quantity in the map
                    quantityMap[item.id] = 1;
                });
    
                // Checkout button
                const checkoutButton = document.createElement('button');
                checkoutButton.classList.add('checkout-button');
                checkoutButton.textContent = 'Proceed to Checkout';

                checkoutButton.addEventListener("click", ()=>{
                    // location.href = "address.html";
                    // window.location.pathname("./addresspage/address.html")
                    window.location.href="/addresspage/address.html"

                })
                parent.append(checkoutButton);
            }
        }
        renderCart();
    </script>
    
</body>
<!-- footer -->

<footer id="footer">
    <div id="footer-container">
        <div id="footer">
            <div class="footer_top">
                <div class="Social_media">
                    <div class="logo">
                        <img src="../Images/Images/home-logo.png" alt="">
                    </div>
                    <div>
                        <a href="#"><img src="../Images/Images/youtube.svg" alt=""></a>
                        <a href="#"><img src="../Images/Images/facebook.svg" alt=""></a>
                        <a href="#"><img src="../Images/Images/Linkedin.png" alt=""></a>
                        <a href="#"><img src="../Images/Images/instagram.svg" alt=""></a>
                    </div>
                </div>
                <div class="about">
                    <div>
                        <h4>MOUNTAIN</h4>
                        <a href="#">Cross Country</a>
                        <a href="#">Downhill</a>
                        <a href="#">Dirt Jump</a>
                        <a href="#">Frames</a>
                    </div>
                    <div>
                        <h4>ROAD</h4>
                        <a href="#">Performance</a>
                        <a href="#">Gravel</a>
                        <a href="#">Cyclocross</a>
                        <a href="#">Triathlon</a>
                    </div>
                    <div>
                        <h4>ACTIVE</h4>
                        <a href="#">Fitness</a>
                        <a href="#">Transport</a>
                        <a href="#">Comfort</a>
                    </div>
                    <div>
                        <h4>ELECTRIC</h4>
                        <a href="#">Road</a>
                        <a href="#">Mountain</a>
                        <a href="#">Active</a>
                    </div>
                    <div>
                        <h4>KIDS</h4>
                        <a href="#">Toddler</a>
                        <a href="#">Little kids</a>
                        <a href="#">Big kids</a>
                    </div>
                    <div>
                        <h4>CUSTOMERS</h4>
                        <a href="#">About us</a>
                        <a href="#">Delivery</a>
                        <a href="#">Payment</a>
                        <a href="#">Contacts</a>
                    </div>
                    <div>
                        <h4>SUPPORT</h4>
                        <a href="#">Support center</a>
                        <a href="#">Warranty</a>
                        <a href="#">Bike registration</a>
                        <a href="#">Shipping &amp; Delivery</a>
                    </div>
                </div>
                <div class="newsletter">
                    <h4>NEWSLETTER</h4>
                    <div>
                        <input type="text" class="news_join" placeholder="Join Our Newsletter">
                        <button>JOIN</button>
                    </div>
                    <p>By submitting your email address you agree to the <span><a href="#" id="terms_con">Terms &amp; Conditions</a></span></p>
                </div>
            </div>
            <div class="footer-bottom">
                <p>
                    <span class="animated-copyright" style="color: #eb001b; font-size: 14px; line-height: 1;">&copy;</span>&nbsp; 1997 - 2022. Specialized Bicycle Components, Inc. All Rights Reserved.
                </p>
            </div>
        </div>
    </div>

</footer>

</html>